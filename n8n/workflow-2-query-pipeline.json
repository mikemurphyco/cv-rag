{
  "name": "CV-RAG: Query Pipeline",
  "nodes": [
    {
      "parameters": {
        "content": "## CV-RAG: Query Pipeline\n\nBased on n8n RAG template",
        "height": 400,
        "width": 800,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [240, -200],
      "typeVersion": 1,
      "id": "sticky-note",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chatTrigger",
      "typeVersion": 1.1,
      "position": [700, 80],
      "id": "chat-trigger",
      "name": "When chat message received",
      "webhookId": "cv-rag-chat"
    },
    {
      "parameters": {
        "model": "nomic-embed-text:latest"
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOllama",
      "typeVersion": 1,
      "position": [920, 240],
      "id": "embeddings-ollama",
      "name": "Embeddings Ollama",
      "credentials": {
        "ollamaApi": {
          "id": "UTJsPhetajaS17pP",
          "name": "Ollama account"
        }
      }
    },
    {
      "parameters": {
        "mode": "retrieve-as-tool",
        "toolName": "query_knowledge_base",
        "toolDescription": "Search Mike Murphy's resume, work experience, skills, education, projects, tutorials, courses, and personal accomplishments (including Camino de Santiago journey). Use this tool to answer ANY question about Mike's professional or personal background.",
        "tableName": "cv_chunks",
        "topK": 5,
        "options": {
          "columnNames": {
            "values": {
              "contentColumnName": "content"
            }
          }
        }
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStorePGVector",
      "typeVersion": 1.3,
      "position": [920, 160],
      "id": "query-data-tool",
      "name": "Query Data Tool",
      "credentials": {
        "postgres": {
          "id": "TZKsgiv75reWBifW",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "model": "llama3.2:latest",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOllama",
      "typeVersion": 1,
      "position": [700, 240],
      "id": "ollama-chat",
      "name": "Ollama Chat Model",
      "credentials": {
        "ollamaApi": {
          "id": "UTJsPhetajaS17pP",
          "name": "Ollama account"
        }
      }
    },
    {
      "parameters": {
        "options": {
          "systemMessage": "You are an AI assistant helping users learn about Mike Murphy. Use the query_knowledge_base tool to search his resume, work experience, skills, education, projects, and personal accomplishments. ALWAYS use the tool to find information before answering. Provide specific, detailed answers based on the retrieved context."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.7,
      "position": [920, 80],
      "id": "ai-agent",
      "name": "AI Agent"
    }
  ],
  "connections": {
    "When chat message received": {
      "main": [[
        {
          "node": "AI Agent",
          "type": "main",
          "index": 0
        }
      ]]
    },
    "Embeddings Ollama": {
      "ai_embedding": [[
        {
          "node": "Query Data Tool",
          "type": "ai_embedding",
          "index": 0
        }
      ]]
    },
    "Query Data Tool": {
      "ai_tool": [[
        {
          "node": "AI Agent",
          "type": "ai_tool",
          "index": 0
        }
      ]]
    },
    "Ollama Chat Model": {
      "ai_languageModel": [[
        {
          "node": "AI Agent",
          "type": "ai_languageModel",
          "index": 0
        }
      ]]
    }
  },
  "pinData": {},
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "7.0.0",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "cv-rag-query-final"
  },
  "tags": [
    {
      "name": "RAG",
      "id": "rag"
    }
  ]
}
